{% extends "base.html" %}

{% block title %}アップロード - Style AI Generator{% endblock %}

{% block content %}
<section>
    <h2 class="h4 mb-3">画像アップロード</h2>
    <div id="drop-zone" class="drop-zone mb-3">
        <div class="text-center">
            <p class="fw-bold mb-1">ここに画像をドラッグ＆ドロップ</p>
            <p class="text-muted small mb-2">JPEG / PNG / WebP、最大10枚、1枚あたり10MBまで</p>
            <button class="btn btn-outline-primary btn-sm" id="file-picker-button" type="button">ファイルを選択</button>
            <input type="file" id="file-input" accept="image/*" multiple hidden>
        </div>
    </div>
    <div id="upload-errors" class="alert alert-danger d-none"></div>
    <div id="uploaded-list" class="row g-3"></div>
</section>

<section class="mt-5">
    <h2 class="h4 mb-3">変換設定</h2>
    <div class="mb-3">
        <label class="form-label">プリセットプロンプト</label>
        <div class="d-flex flex-wrap gap-2" id="prompt-preset-container">
            <span class="text-muted">読み込み中...</span>
        </div>
    </div>
    <div class="mb-3">
        <label for="custom-prompt" class="form-label">カスタムプロンプト</label>
        <textarea id="custom-prompt" class="form-control" rows="4" placeholder="変換内容を具体的に記述してください"></textarea>
    </div>
    <div class="mb-3 col-md-3">
        <label for="generation-count" class="form-label">生成枚数</label>
        <select id="generation-count" class="form-select">
            <option value="1">1枚</option>
            <option value="2">2枚</option>
            <option value="3">3枚</option>
            <option value="4">4枚</option>
            <option value="5">5枚</option>
        </select>
    </div>
    <div class="d-flex gap-2">
        <button class="btn btn-primary" id="start-conversion" type="button" disabled>変換を開始</button>
        <a class="btn btn-outline-secondary" href="{% url 'frontend:gallery' %}">ギャラリーに移動</a>
    </div>
</section>

<template id="uploaded-item-template">
    <div class="col-md-4">
        <div class="card h-100 shadow-sm">
            <img src="" class="card-img-top uploaded-thumb" alt="">
            <div class="card-body">
                <h5 class="card-title small uploaded-name"></h5>
                <p class="card-text text-muted small uploaded-size"></p>
                <button class="btn btn-sm btn-outline-danger w-100 remove-upload" type="button">削除</button>
            </div>
        </div>
    </div>
</template>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/prompts.js' %}"></script>
<script src="{% static 'js/upload.js' %}"></script>
<script src="{% static 'js/convert.js' %}"></script>
{% endblock %}
